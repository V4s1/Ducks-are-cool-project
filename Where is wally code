class Square {
    constructor(x, y, isWally) {
        this.x = x;
        this.y = y;
        this.isWally = isWally;
        this.speedX = random(-0.01, 0.04); // Random horizontal speed
        this.speedY = random(-0.01, 0.04); // Random vertical speed
      
      // Randomly assign a duck image to non-Wally squares
        if (!this.isWally) {
            this.duckImage = random(ducks);
        } else {
            this.gooseImage = goose
        }
    }

    move() {
        // Move the square
        if (!this.isWally) {
            this.x += this.speedX;
            this.y += this.speedY;

            // Bounce off the edges of the grid
            if (this.x < 0 || this.x > gridSize - 1) {
                this.speedX *= -1;
            }
            if (this.y < 0 || this.y > gridSize - 1) {
                this.speedY *= -1;
            }
        }
    }

    display() {
        if (this.isWally) {
            // Draw the duck image at this square's location
            image(this.gooseImage, this.x * squareSize, this.y * squareSize, squareSize, squareSize);
        } else {
          // Draw the duck image at this square's location
            image(this.duckImage, this.x * squareSize, this.y * squareSize, squareSize, squareSize);
        }
    }
}

let squares = [];
const gridSize = 6; // 5x5 grid
const squareSize = 80; // Size of each square
let wallySquare;
let ducks = [];
let goose

// Load the image.
function preload() {
  ducks[0] = loadImage('/assets/Duck1.png');
  ducks[1] = loadImage('/assets/Duck2.png');
  ducks[2] = loadImage('/assets/Duck3.png');
  goose = loadImage('/assets/Goose.png')
}

function setup() {
    createCanvas(gridSize * squareSize, gridSize * squareSize);
    let randomX = floor(random(gridSize));
    let randomY = floor(random(gridSize));
    wallySquare = new Square(randomX, randomY, true); // Create Wally

    // Create other squares
    for (let i = 0; i < gridSize; i++) {
        for (let j = 0; j < gridSize; j++) {
            if (!(i === randomX && j === randomY)) {
                squares.push(new Square(i, j, false));
            }
        }
    }
}

function draw() {
    background(255, 255, 255, 50);
    wallySquare.display(); // Draw Wally
    for (let square of squares) {
        square.move(); // Move other squares
        square.display(); // Draw other squares
    }
    displayMessage();
}

let gameMessage = "";

function displayMessage() {
    fill(255, 255, 255);
    textSize(24);
    textAlign(CENTER, CENTER);
    text(gameMessage, width / 2, height - 30);
}

function mousePressed() {
    let col = floor(mouseX / squareSize);
    let row = floor(mouseY / squareSize);

    // Check if the clicked square is Wally's
    if (col === wallySquare.x && row === wallySquare.y) {
        gameMessage = 'You found Wally!';
        noLoop(); // Stop the draw loop
    } else {
        gameMessage = 'Try again!';
    }
}
